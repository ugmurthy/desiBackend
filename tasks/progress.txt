## Codebase Patterns
- Use `type` imports for TypeScript types with verbatimModuleSyntax enabled (e.g., `import type { FastifyPluginAsync }`)
- Run `bun run typecheck` to verify TypeScript correctness
- SQLite: Use Bun's built-in `bun:sqlite` module for database operations
- Admin DB path: `~/.desiAgent/admin.db`
- Tenant DB path: `~/.desiAgent/tenants/{tenant_id}/agent.db`
- Use bcrypt for password/API key hashing (cost factor 12)
- All timestamps stored as Unix timestamps (seconds)
---

## 2026-01-22 - US-001
Thread: https://ampcode.com/threads/T-019be5cf-5610-7741-b671-11973549e39a
- Implemented Bootstrap CLI Command
- Files changed: scripts/bootstrap.ts, package.json
- **Learnings for future iterations:**
  - The `--force` flag is parsed from `process.argv.slice(2)`
  - CLI entry point is scripts/bootstrap.ts, to be extended by bootstrap service in US-009
  - Script uses async main() pattern with proper exit codes
---

## 2026-01-22 - US-002
Thread: https://ampcode.com/threads/T-019be5d0-90b8-701d-8699-d7a799023930
- Implemented Admin Database Schema Extensions
- Files changed: src/db/admin-schema.ts
- **Learnings for future iterations:**
  - All schema tables are created in single `initializeAdminDatabase()` call using multi-statement exec
  - TypeScript interfaces defined for SuperAdmin, AdminApiKey, and Agent types
  - SQLite booleans stored as INTEGER (0 or 1) - see `active` field in agents table
  - UNIQUE constraint added using `UNIQUE(name, version)` syntax in table definition
---

## 2026-01-22 - US-003
Thread: https://ampcode.com/threads/T-019be5d0-90b8-701d-8699-d7a799023930
- Implemented Super Admin Creation service
- Files changed: src/services/super-admin.ts
- **Learnings for future iterations:**
  - Super admin service is in src/services/super-admin.ts
  - `createSuperAdmin()` returns `{ admin, created }` to indicate if admin was newly created or already existed
  - Reads ADMIN_EMAIL and ADMIN_NAME from env vars, with defaults
  - Uses bcrypt with cost factor 12 for password hashing (pattern in Codebase Patterns)
  - `force` option updates existing admin instead of skipping
---

